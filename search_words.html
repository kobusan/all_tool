<html lang="UTF-8">
  <head>
    <meta charset="UTF-8" />
    <style>
      .loading {
        height: 100vh;
        position: relative;
      }
      .noloading {
        display: none;
      }
    </style>
  </head>
  <body>
    <div id="loading" class="noloading">
      <div
        style="position: absolute; left: 50%; top: 50%; transform: translate(-50%, -50%); width: 100px; height: 100px; background-color: #fff;"
      >
        <img
          src="https://pecopla.net/wp-content/themes/2017.pecopla/demo/SVG-Loaders/svg-loaders/tail-spin.svg"
          style="img{ background-image: url('https://pecopla.net/wp-content/themes/2017.pecopla/demo/SVG-Loaders/svg-loaders/tail-spin.svg'); background-repeat: no-repeat; background-position: center center; }"
        />
      </div>
    </div>

    単語リスト <span id="wordscount"></span><br />
    <textarea id="words" style="height: calc( 1.3em * 10 );"></textarea><br />
    hits リスト <span id="resultcount"></span><br />
    <textarea id="hitwords" style="height: calc( 1.3em * 3 );"></textarea>
    <br />
    <br />
    検索する文<br />
    <textarea id="text" style="height: calc( 1.3em * 20 ); line-height: 1.3; width: 100%;">
おやゆずりの無鉄砲むてっぽうで小供の時から損ばかりしている。小学校に居る時分学校の二階から飛び降りて一週間ほど腰こしを抜ぬかした事がある。なぜそんな無闇むやみをしたと聞く人があるかも知れぬ。別段深い理由でもない。新築の二階から首を出していたら、同級生の一人が冗談じょうだんに、いくら威張いばっても、そこから飛び降りる事は出来まい。弱虫やーい。と囃はやしたからである。小使こづかいに負ぶさって帰って来た時、おやじが大きな眼めをして二階ぐらいから飛び降りて腰を抜かす奴やつがあるかと云いったから、この次は抜かさずに飛んで見せますと答えた。
　親類のものから西洋製のナイフを貰もらって奇麗きれいな刃はを日に翳かざして、友達ともだちに見せていたら、一人が光る事は光るが切れそうもないと云った。切れぬ事があるか、何でも切ってみせると受け合った。そんなら君の指を切ってみろと注文したから、何だ指ぐらいこの通りだと右の手の親指の甲こうをはすに切り込こんだ。幸さいわいナイフが小さいのと、親指の骨が堅かたかったので、今だに親指は手に付いている。しかし創痕きずあとは死ぬまで消えぬ。
　庭を東へ二十歩に行き尽つくすと、南上がりにいささかばかりの菜園があって、真中まんなかに栗くりの木が一本立っている。これは命より大事な栗だ。実の熟する時分は起き抜けに背戸せどを出て落ちた奴を拾ってきて、学校で食う。菜園の西側が山城屋やましろやという質屋の庭続きで、この質屋に勘太郎かんたろうという十三四の倅せがれが居た。勘太郎は無論弱虫である。弱虫の癖くせに四つ目垣を乗りこえて、栗を盗ぬすみにくる。ある日の夕方折戸おりどの蔭かげに隠かくれて、とうとう勘太郎を捕つらまえてやった。その時勘太郎は逃にげ路みちを失って、一生懸命いっしょうけんめいに飛びかかってきた。向むこうは二つばかり年上である。弱虫だが力は強い。鉢はちの開いた頭を、こっちの胸へ宛あててぐいぐい押おした拍子ひょうしに、勘太郎の頭がすべって、おれの袷あわせの袖そでの中にはいった。邪魔じゃまになって手が使えぬから、無暗に手を振ふったら、袖の中にある勘太郎の頭が、右左へぐらぐら靡なびいた。しまいに苦しがって袖の中から、おれの二の腕うでへ食い付いた。痛かったから勘太郎を垣根へ押しつけておいて、足搦あしがらをかけて向うへ倒たおしてやった。山城屋の地面は菜園より六尺がた低い。勘太郎は四つ目垣を半分崩くずして、自分の領分へ真逆様まっさかさまに落ちて、ぐうと云った。勘太郎が落ちるときに、おれの袷の片袖がもげて、急に手が自由になった。その晩母が山城屋に詫わびに行ったついでに袷の片袖も取り返して来た。
　この外いたずらは大分やった。大工の兼公かねこうと肴屋さかなやの角かくをつれて、茂作もさくの人参畠にんじんばたけをあらした事がある。人参の芽が出揃でそろわぬ処ところへ藁わらが一面に敷しいてあったから、その上で三人が半日相撲すもうをとりつづけに取ったら、人参がみんな踏ふみつぶされてしまった。古川ふるかわの持っている田圃たんぼの井戸いどを埋うめて尻しりを持ち込まれた事もある。太い孟宗もうそうの節を抜いて、深く埋めた中から水が湧わき出て、そこいらの稲いねにみずがかかる仕掛しかけであった。その時分はどんな仕掛か知らぬから、石や棒ぼうちぎれをぎゅうぎゅう井戸の中へ挿さし込んで、水が出なくなったのを見届けて、うちへ帰って飯を食っていたら、古川が真赤まっかになって怒鳴どなり込んで来た。たしか罰金ばっきんを出して済んだようである。
　おやじはちっともおれを可愛かわいがってくれなかった。母は兄ばかり贔屓ひいきにしていた。この兄はやに色が白くって、芝居しばいの真似まねをして女形おんながたになるのが好きだった。おれを見る度にこいつはどうせ碌ろくなものにはならないと、おやじが云った。乱暴で乱暴で行く先が案じられると母が云った。なるほど碌なものにはならない。ご覧の通りの始末である。行く先が案じられたのも無理はない。ただ懲役ちょうえきに行かないで生きているばかりである。
　母が病気で死ぬ二三日にさんち前台所で宙返りをしてへっついの角で肋骨あばらぼねを撲うって大いに痛かった。母が大層怒おこって、お前のようなものの顔は見たくないと云うから、親類へ泊とまりに行っていた。するととうとう死んだと云う報知しらせが来た。そう早く死ぬとは思わなかった。そんな大病なら、もう少し大人おとなしくすればよかったと思って帰って来た。そうしたら例の兄がおれを親不孝だ、おれのために、おっかさんが早く死んだんだと云った。口惜くやしかったから、兄の横っ面を張って大変叱しかられた。
　母が死んでからは、おやじと兄と三人で暮くらしていた。おやじは何にもせぬ男で、人の顔さえ見れば貴様は駄目だめだ駄目だと口癖のように云っていた。何が駄目なんだか今に分らない。妙みょうなおやじがあったもんだ。兄は実業家になるとか云ってしきりに英語を勉強していた。元来女のような性分で、ずるいから、仲がよくなかった。十日に一遍いっぺんぐらいの割で喧嘩けんかをしていた。ある時将棋しょうぎをさしたら卑怯ひきょうな待駒まちごまをして、人が困ると嬉うれしそうに冷やかした。あんまり腹が立ったから、手に在った飛車を眉間みけんへ擲たたきつけてやった。眉間が割れて少々血が出た。兄がおやじに言付いつけた。おやじがおれを勘当かんどうすると言い出した。</textarea
    >
    <br />
    <br />
    <input type="button" value="검색" onclick="search()" />
    <br />
    <br />

    結果<br />
    <div>
      <p id="result" style="word-wrap: break-all;"></p>
    </div>

    <script>
      function search() {
        var loading = document.getElementById('loading');
        loading.classList.replace('noloading', 'loading');

        setTimeout(() => {
          try {
            var words = document.getElementById('words').value.split('\n');
            var te = document.getElementById('text').value;
            var result = document.getElementById('result');
            document.getElementById('wordscount').innerHTML = `(${words.length})件`;
            var hits = [];

            words.forEach(word => {
              var targetStr = word.trim();

              if (!targetStr || targetStr === '') {
                console.log('null');
              } else {
                targetStr = targetStr.replace(/\*/g, '\\*');
                targetStr = targetStr.replace(/\./g, '\\.');
                targetStr = targetStr.replace(/\+/g, '\\+');
                targetStr = targetStr.replace(/\^/g, '\\^');
                targetStr = targetStr.replace(/\|/g, '\\|');
                targetStr = targetStr.replace(/\[/g, '\\[');
                targetStr = targetStr.replace(/\]/g, '\\]');
                targetStr = targetStr.replace(/\(/g, '\\(');
                targetStr = targetStr.replace(/\)/g, '\\)');
                targetStr = targetStr.replace(/\?/g, '\\?');
                targetStr = targetStr.replace(/\$/g, '\\$');
                targetStr = targetStr.replace(/\{/g, '\\{');
                targetStr = targetStr.replace(/\}/g, '\\}');
                if (!!~te.indexOf(targetStr)) hits.push(targetStr);
                var regExp = new RegExp(targetStr, 'g');
                te = te.replace(regExp, '<span style=color:cyan >' + word + '</span>');
              }
            });

            result.innerHTML = te;
            document.getElementById('resultcount').innerHTML = `(${hits.length})件`;
            loading.classList.replace('loading', 'noloading');
            hitwords.innerHTML = hits.join('\n');
          } catch (error) {
            alert(error.message);
            loading.classList.replace('loading', 'noloading');
          }
        }, 500);
      }
    </script>
  </body>
</html>
